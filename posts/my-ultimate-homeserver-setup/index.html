<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="My ultimate homeserver setup" /><meta property="og:locale" content="en" /><meta name="description" content="My homeserver supports a huge and growing collection of your favorite open source services. In order to use it you have to be familiar with using the terminal. If you prefer a graphical user interface take a look at umbrel." /><meta property="og:description" content="My homeserver supports a huge and growing collection of your favorite open source services. In order to use it you have to be familiar with using the terminal. If you prefer a graphical user interface take a look at umbrel." /><link rel="canonical" href="https://www.simonhaas.eu/blog/blog/posts/my-ultimate-homeserver-setup/" /><meta property="og:url" content="https://www.simonhaas.eu/blog/blog/posts/my-ultimate-homeserver-setup/" /><meta property="og:site_name" content="Simon`s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-06-05T19:57:22+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="My ultimate homeserver setup" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-22T13:33:34+02:00","datePublished":"2022-06-05T19:57:22+02:00","description":"My homeserver supports a huge and growing collection of your favorite open source services. In order to use it you have to be familiar with using the terminal. If you prefer a graphical user interface take a look at umbrel.","headline":"My ultimate homeserver setup","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.simonhaas.eu/blog/blog/posts/my-ultimate-homeserver-setup/"},"url":"https://www.simonhaas.eu/blog/blog/posts/my-ultimate-homeserver-setup/"}</script><title>My ultimate homeserver setup | Simon`s Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Simon`s Blog"><meta name="application-name" content="Simon`s Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href=""><link rel="stylesheet" href=""><link rel="stylesheet" href=""><link rel="stylesheet" href="/blog/assets/css/style.css"><link rel="stylesheet" href=""><link rel="stylesheet" href=""> <script src=""></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script> <script async defer data-website-id="5d62a748-0b2d-4d34-a649-c71329796197" src="https://umami.simonhaas.eu/umami.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/blog/" id="avatar" class="rounded-circle"><img src="/blog/profile_picture.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/blog/">Simon`s Blog</a></h1><p class="site-subtitle fst-italic mb-0">A blog about stuff I am interested in.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span></span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/simonhaas" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['me','simonhaas.eu'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/blog/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/blog/"> </a> </span> <span>My ultimate homeserver setup</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel"></button></div></header><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><article class="px-1"><h1 data-toc-skip>My ultimate homeserver setup</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1654451842" data-df="DD/MM/YYYY" data-bs-toggle="tooltip" data-bs-placement="bottom" > 05/06/2022 </time> </span> <span> Updated <time data-ts="1655897614" data-df="DD/MM/YYYY" data-bs-toggle="tooltip" data-bs-placement="bottom" > 22/06/2022 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/simonhaas">Simon Haas</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="461 " > <em>2 </em> </span></div></div></div><div class="post-content"><p>My <a href="https://github.com/SimonHaas/homeserver">homeserver</a> supports a huge and growing collection of your favorite open source services. In order to use it you have to be familiar with using the terminal. If you prefer a graphical user interface take a look at <a href="https://umbrel.com/">umbrel</a>.</p><p>To setup your own homeserver you should have an own domain. You can get one for free at <a href="https://www.freenom.com/de/index.html?lang=de">Freenom</a>. To get automated certificates point the domain`s NS-records to a provider that supports the acme protocol and wildcard A records. I use <a href="https://www.digitalocean.com/">Digitalocean</a> it is free. You have to create an account and add your domain. Then go back to Freenom and change the nameservers of your domain to</p><div class="language-shell highlighter-rouge"><div class="highlight">class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>ns1.digitalocean.com.
ns2.digitalocean.com.
ns3.digitalocean.com.
</pre></div></div><p>and add a new A-record with an asterix (*) as subdomain (wildcard) with the IP address of your server.</p><p>Further requirenments are to have docker and git installed.</p><div class="language-shell highlighter-rouge"><div class="highlight">class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>curl <span class="nt">-fsSL</span> https://get.docker.com <span class="nt">-o</span> get-docker.sh
sh get-docker.sh
dockerd-rootless-setuptool.sh <span class="nb">install
sudo </span>usermod <span class="nt">-aG</span> docker <span class="nv">$USER</span>
<span class="nb">sudo </span>apt <span class="nb">install </span>git
</pre></div></div><p>Now you can clone the homeserver repository and create a docker network</p><div class="language-shell highlighter-rouge"><div class="highlight">class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>git clone https://github.com/SimonHaas/homeserver.git
<span class="nb">cd </span>homeserver
docker network create zone1
</pre></div></div><p>Copy and modify the main .env file. Set your timezone, domain and the services you want to have started. You can leave the default services until you have verified that everything is setup correctly and then add more.</p><div class="language-shell highlighter-rouge"><div class="highlight">class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">cp</span> .env.example .env
nano .env
</pre></div></div><p>Then go to traefik and edit the .env file there as well. Here you have to enter your email. If you use Digitalocean as your DNS provider you only have to add an auth-key. You can get one in the <a href="https://cloud.digitalocean.com/account/api/tokens">settings of digitalocean</a>. If you use another provider take a look at <a href="https://doc.traefik.io/traefik/https/acme/#providers">available acme providers</a>.</p><div class="language-shell highlighter-rouge"><div class="highlight">class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">cd </span>services/traefik
<span class="nb">cp</span> .env.example .env
nano .env
</pre></div></div><p>Now we are basically ready to go. But first let`s test if your DNS setup is correct. To get a test-certificate edit the docker-compose.yml file of traefik and remove the ‘#’ sign of the line which specifies the certificate resolver to use the letsencrypt staging servers. Start traefik with</p><div class="language-shell highlighter-rouge"><div class="highlight">class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker compose up
</pre></div></div><p>After traefik has started you can visit traefik at https://traefik.<your-domain>/dashboard/#/ The browser should warn you that the connection is not secure because of an unknown certificate authority but this is indented since we use the letsencrypt staging server. Use Crtl-C to stop traefik again, remove traefik`s data-folder and add the '#' sign in the docker-compose file again by running</your-domain></p><div class="language-shell highlighter-rouge"><div class="highlight">class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>git reset <span class="nt">--hard</span>
</pre></div></div><p>Now go two levels up again and run the homeserver-script. Go to each service`s folder you have specified in the main .env file and modify the corresponding .env file accordingly.</p><div class="language-shell highlighter-rouge"><div class="highlight">class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">cd</span> ../..
./script.sh up <span class="nt">-d</span>
</pre></div></div><p>Now your specified services should be up and running.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href="/blog/categories/homeserver/" >homeserver</a >, <a href="/blog/categories/docker/" >docker</a ></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2" ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted"></span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=My%20ultimate%20homeserver%20setup%20-%20Simon%60s%20Blog&url=https%3A%2F%2Fwww.simonhaas.eu%2Fblog%2Fblog%2Fposts%2Fmy-ultimate-homeserver-setup%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=My%20ultimate%20homeserver%20setup%20-%20Simon%60s%20Blog&u=https%3A%2F%2Fwww.simonhaas.eu%2Fblog%2Fblog%2Fposts%2Fmy-ultimate-homeserver-setup%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fwww.simonhaas.eu%2Fblog%2Fblog%2Fposts%2Fmy-ultimate-homeserver-setup%2F&text=My%20ultimate%20homeserver%20setup%20-%20Simon%60s%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="" data-title-succeed="" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div><script> var remark_config = { host: "https://remark.simonhaas.eu", site_id: "remark", theme: toggle.modeStatus, }; </script> <script> !(function (e, n) { for (var o = 0; o < e.length; o++) { var r = n.createElement("script"), c = ".js", d = n.head || n.body; "noModule" in r ? ((r.type = "module"), (c = ".mjs")) : (r.async = !0), (r.defer = !0), (r.src = remark_config.host + "/web/" + e[o] + c), d.appendChild(r); } })(remark_config.components || ["embed"], document); </script><div id="remark42"></div><script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script> <script> window.addEventListener( "message", (event) => { window.REMARK42.changeTheme(event.data.message); }, false ); </script></div></article></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p> © <time>2024</time> <a href="https://github.com/simonhaas">Simon Haas</a>.</p><p></p></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script defer src="/blog/unregister.js"></script>
