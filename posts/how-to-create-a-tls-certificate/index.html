<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="How to create a free TLS certificate" /><meta property="og:locale" content="en" /><meta name="description" content="What is a TLS certificate" /><meta property="og:description" content="What is a TLS certificate" /><link rel="canonical" href="https://www.simonhaas.eu/blog/blog/posts/how-to-create-a-tls-certificate/" /><meta property="og:url" content="https://www.simonhaas.eu/blog/blog/posts/how-to-create-a-tls-certificate/" /><meta property="og:site_name" content="Simon`s Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-01-14T18:57:22+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="How to create a free TLS certificate" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-06-05T11:04:43+02:00","datePublished":"2020-01-14T18:57:22+01:00","description":"What is a TLS certificate","headline":"How to create a free TLS certificate","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.simonhaas.eu/blog/blog/posts/how-to-create-a-tls-certificate/"},"url":"https://www.simonhaas.eu/blog/blog/posts/how-to-create-a-tls-certificate/"}</script><title>How to create a free TLS certificate | Simon`s Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/blog/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/blog/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/blog/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/blog/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/blog/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Simon`s Blog"><meta name="application-name" content="Simon`s Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/blog/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href=""><link rel="stylesheet" href=""><link rel="stylesheet" href=""><link rel="stylesheet" href="/blog/assets/css/style.css"><link rel="stylesheet" href=""><link rel="stylesheet" href=""> <script src=""></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script> <script async defer data-website-id="5d62a748-0b2d-4d34-a649-c71329796197" src="https://umami.simonhaas.eu/umami.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/blog/" id="avatar" class="rounded-circle"><img src="/blog/profile_picture.jpg" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a><h1 class="site-title"> <a href="/blog/">Simon`s Blog</a></h1><p class="site-subtitle fst-italic mb-0">A blog about stuff I am interested in.</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/blog/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span></span> </a><li class="nav-item"> <a href="/blog/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/blog/tags/" class="nav-link"> <i class="fa-fw fas fa-tag"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/blog/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/blog/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/simonhaas" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="javascript:location.href = 'mailto:' + ['me','simonhaas.eu'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/blog/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/blog/"> </a> </span> <span>How to create a free TLS certificate</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel"></button></div></header><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><article class="px-1"><h1 data-toc-skip>How to create a free TLS certificate</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1579024642" data-df="DD/MM/YYYY" data-bs-toggle="tooltip" data-bs-placement="bottom" > 14/01/2020 </time> </span> <span> Updated <time data-ts="1654419883" data-df="DD/MM/YYYY" data-bs-toggle="tooltip" data-bs-placement="bottom" > 05/06/2022 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/simonhaas">Simon Haas</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="1141 " > <em>6 </em> </span></div></div></div><div class="post-content"><h2 id="what-is-a-tls-certificate">What is a TLS certificate</h2><p>A TLS certificate is basically a file with various data like the doamins it is valid for, expiration date and most importantly a public key. This file is signed by a certificate authority (CA), which gurantees that the public key really belongs to the person operating the website.</p><h2 id="what-do-i-need-a-tls-certificate-for">What do I need a TLS certificate for</h2><p>A TLS certificate is to secure connections via the internet. The public key is used to authenticate the server, so that you are really visiting the authentic site you are expecting and that you are not fooled by a hacker. Additionally it turns an unencrypted http site into an encrypted https site. This means that the traffic between a client e.g. an internet browser and the server which is hosting the site you are visiting is encrypted and no one can see what you are doing on that website. Keep in mind that the domain you are visiting is still visible to an eavesdropper. In this specific case this means the site you are visiting is indeed operated by the person, me, owning the domain simonhaas.eu. To load this site there was traffic over the public internet. Someone monitoring this would see that you are visiting simonhaas.eu but they could not see the specific post, the content or any data you would fill into a form if there were any.</p><h2 id="different-kinds-of-tls-certificates">Different kinds of TLS certificates</h2><p>A certificate authority signs the public key. You do not sign anything in real life without checking the validity of the thing you should sign first, nor does a CA. There are three different levels of validation a CA can perform to be sure the person requesting a certificate is authorized to do so.</p><ol><li>Domain Validation - this is the weakest form of validation. Here the CA only checks if one has administrative access over a domain. The padlock in your browser is green.<li>Organisation Validation - here the CA checks if the organisation requesting the signature really exists, e.g. through an official register. The padlock in your browser is geen followed by the organisations name.<li>Extended Validation - here the CA visits and physically verifies the existance of the organisation. The padlock in your browser is green followed by the organistations name and their country code.</ol><p>If you really trust a website depends on the kind of validation and the CA itself. If you do not trust a CA their signatures are basically worthless and you should’t trust them either.</p><h2 id="how-to-get-a-tls-certificate-for-free">How to get a TLS certificate for free</h2><p>Most CAs take money for certificates which is totally legit because it is a service they perform for you. The CA Let’s Encrypt is different. The issue free certificates. Consequently the only perform the weakest form of validation, Domain Validation. That is why you should not trust your banks online banking if it is only secured by an Let’s Encrypt certificate. But if you only want to encrypt a simple blog where in the case the site got hacked there is no way you could lose all your money or that very personal information would be leaked it is just fine.</p><h2 id="different-way-for-domain-validation">Different way for Domain Validation</h2><p>To validate the domain Let’s Encrypt can use a few different methods, defined in the ACME protocol, called a challenge. The most common challenge is HTTP-01. Here you get a token from Let’s Encrypt and to prove your domain ownership you should place the token under a specific path on your website. The Let’s Encrypt Server now visits the specific path and looks for the token. If it is there the CA knows that you have control over the domain and gives you a certificate. If you want to run a home server in your LAN which is not connected to the internet this can not be done. You can still get a certificate via the DNS-01 challenge. Here you get a token from Let’s Encrypt and you must create a TXT record for your your domain containing the token. Let’s Encrypt’s server checks if the TXT record with the given token exists and gives you a certificate if so.</p><h2 id="actual-steps-to-get-a-tls-certificate">Actual steps to get a TLS certificate</h2><p>You can run the following command from any computer. It does not have to be the server hosting your site. But in the end the certificate has to be on the server.</p><h3 id="prerequisits">Prerequisits</h3><p>You have to have your own domain. You can get one from <a href="https://www.namecheap.com">https://www.namecheap.com</a>.</p><h3 id="1-install-certbot">1. Install certbot</h3><p>Certbot is a command line tool to interact with Let’s Encrypt.</p><div class="language-shell highlighter-rouge"><div class="highlight">class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt update
<span class="nb">sudo </span>apt <span class="nb">install </span>certbot
</pre></div></div><h3 id="2-request-the-certificate">2. Request the certificate</h3><p>In the following command please change <code class="language-plaintext highlighter-rouge">*.&lt;your-domain&gt;</code> to your specific domain. The <code class="language-plaintext highlighter-rouge">*</code> means that you want a wildcard certificate which is valid for every subdomain. If you first want to test the process use Let’s Encrypt staging server <code class="language-plaintext highlighter-rouge">https://acme-staging-v02.api.letsencrypt.org/directory</code> You can only make a limited number of requests in a specific timeperiod to the production server before being blocked. Do not press Enter when promted yet. Also keep in mind that your IP address will be publicly logged.</p><div class="language-shell highlighter-rouge"><div class="highlight">class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>certbot certonly <span class="nt">--manual</span> <span class="nt">--manual-public-ip-logging-ok</span> <span class="nt">--preferred-challenges</span> dns-01 <span class="nt">--server</span> https://acme-v02.api.letsencrypt.org/directory <span class="nt">-d</span> <span class="s2">"*.&lt;your-domain&gt;"</span>
</pre></div></div><p>The output will look something like the following.</p><figure class="highlight"><pre><code class="language-shell" data-lang="shell">Saving debug log to /var/log/letsencrypt/letsencrypt.log
Plugins selected: Authenticator manual, Installer None
Obtaining a new certificate
Performing the following challenges:
dns-01 challenge <span class="k">for</span> <span class="k">*</span>.&lt;your-domain&gt;

- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Please deploy a DNS TXT record under the name
_acme-challenge.&lt;your-domain&gt; with the following value:

HlArNfLZsJ5x224B9ATJ7eTCIP82LbFAydte4z4VDFw

Before continuing, verify the record is deployed.
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Press Enter to Continue</code></pre></figure><h3 id="3-create-the-txt-record">3. Create the TXT record</h3><p>Go to your DNS-provider e.g. namecheap and add a new TXT record. The name has to be <code class="language-plaintext highlighter-rouge">_acme-challenge</code> and as value use the token displayed in your output, in this example <code class="language-plaintext highlighter-rouge">HlArNfLZsJ5x224B9ATJ7eTCIP82LbFAydte4z4VDFw</code>.</p><p>Because of the distributed DNS architecture it takes up to 24 hours until every DNS server gets updated. Waiting onyl one to two hours has always worded for me. If you want to be sure you can use a service like <a href="https://www.nslookuptool.com">https://www.nslookuptool.com</a> to check if the TXT record is already videly spread. If you press Enter and Let’s Encrypt can not verify your TXT record you have to run the command again, get a new token and wait for a few hours again.</p><p>If everything worked fine you now have a TLS certificate signed by Let’s Encrypt which can be use to secure your websites.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href="/blog/categories/homeserver/" >homeserver</a >, <a href="/blog/categories/letsencrypt/" >letsencrypt</a >, <a href="/blog/categories/tls/" >tls</a >, <a href="/blog/categories/https/" >https</a ></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2" ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted"></span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=How%20to%20create%20a%20free%20TLS%20certificate%20-%20Simon%60s%20Blog&url=https%3A%2F%2Fwww.simonhaas.eu%2Fblog%2Fblog%2Fposts%2Fhow-to-create-a-tls-certificate%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=How%20to%20create%20a%20free%20TLS%20certificate%20-%20Simon%60s%20Blog&u=https%3A%2F%2Fwww.simonhaas.eu%2Fblog%2Fblog%2Fposts%2Fhow-to-create-a-tls-certificate%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fwww.simonhaas.eu%2Fblog%2Fblog%2Fposts%2Fhow-to-create-a-tls-certificate%2F&text=How%20to%20create%20a%20free%20TLS%20certificate%20-%20Simon%60s%20Blog" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="" data-title-succeed="" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div><script> var remark_config = { host: "https://remark.simonhaas.eu", site_id: "remark", theme: toggle.modeStatus, }; </script> <script> !(function (e, n) { for (var o = 0; o < e.length; o++) { var r = n.createElement("script"), c = ".js", d = n.head || n.body; "noModule" in r ? ((r.type = "module"), (c = ".mjs")) : (r.async = !0), (r.defer = !0), (r.src = remark_config.host + "/web/" + e[o] + c), d.appendChild(r); } })(remark_config.components || ["embed"], document); </script><div id="remark42"></div><script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return 'mode'; } static get MODE_ATTR() { return 'data-mode'; } static get DARK_MODE() { return 'dark'; } static get LIGHT_MODE() { return 'light'; } static get ID() { return 'mode-toggle'; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener('change', () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia('(prefers-color-scheme: dark)'); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { document.documentElement.setAttribute(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { document.documentElement.removeAttribute(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage( { direction: ModeToggle.ID, message: this.modeStatus }, '*' ); } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.notify(); } /* flipMode() */ } /* ModeToggle */ const modeToggle = new ModeToggle(); </script> <script> window.addEventListener( "message", (event) => { window.REMARK42.changeTheme(event.data.message); }, false ); </script></div></article></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p> © <time>2024</time> <a href="https://github.com/simonhaas">Simon Haas</a>.</p><p></p></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/blog/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script defer src="/blog/assets/js/dist/post.min.js"></script> <script defer src="/blog/unregister.js"></script>
